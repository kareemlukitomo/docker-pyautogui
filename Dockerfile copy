FROM python:3.8-slim-bullseye

RUN apt-get update -y \
  && apt-get install libgl1-mesa-dev libgl1-mesa-glx xvfb -y --no-install-recommends \
  && apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false \
  && rm -rf /var/lib/apt/lists/*

RUN pip install pyautogui \
  && rm -rf $(pip cache dir)

RUN mkdir -p /app/data

RUN apt-get update && apt-get install -y \
  x11-apps \
  x11-xserver-utils \
  libxrender1 \
  libxtst6 \
  libxi6

RUN apt-get install -y xauth

RUN apt-get install python3-tk python3-dev -y

RUN apt-get install gnome-screenshot -y

RUN apt-get install firefox-esr -y

RUN apt-get install firefox-esr -y

WORKDIR /app/
COPY test.py set_xvfb.sh /app/
ENTRYPOINT ["/app/set_xvfb.sh"]